---
layout: default
---
<style>
  body {
    margin: 0;
    overflow: hidden;
    touch-action: none;
    user-select: none;
    -webkit-user-select: none;
  }

  #svgbox {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
  }

  .toolbar {
    position: fixed;
    top: 5px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.95);
    padding: 6px 10px;
    border-radius: 20px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.2);
    display: flex;
    gap: 5px;
    align-items: center;
    flex-wrap: nowrap;
    justify-content: center;
    max-width: 96vw;
    overflow-x: auto;
    overflow-y: hidden;
    z-index: 1000;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .toolbar::-webkit-scrollbar {
    display: none;
  }

  .color-btn {
    width: 28px;
    height: 28px;
    min-width: 28px;
    border: 2px solid #fff;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 1px 4px rgba(0,0,0,0.2);
  }

  .color-btn:active, .color-btn.active {
    transform: scale(1.15);
    box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    border-color: #333;
  }

  .tool-btn {
    background: #fff;
    border: 2px solid #ddd;
    border-radius: 8px;
    padding: 5px 9px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    white-space: nowrap;
    line-height: 1;
  }

  .tool-btn:active {
    transform: scale(0.95);
    background: #f0f0f0;
  }

  .tool-btn.active {
    background: #4CAF50;
    color: white;
    border-color: #45a049;
  }

  .size-control {
    display: flex;
    align-items: center;
    gap: 5px;
    background: white;
    padding: 3px 8px;
    border-radius: 8px;
    border: 2px solid #ddd;
  }

  #sizeSlider {
    width: 60px;
    height: 6px;
    cursor: pointer;
  }

  .brush-preview {
    display: inline-block;
    border-radius: 50%;
    border: 2px solid #333;
    transition: all 0.2s;
  }

  .separator {
    width: 1px;
    height: 24px;
    background: #ddd;
    flex-shrink: 0;
  }

  @media (max-width: 768px) {
    .toolbar {
      top: 3px;
      padding: 5px 8px;
      gap: 4px;
      flex-wrap: wrap;
      max-width: 98vw;
    }
    .color-btn {
      width: 26px;
      height: 26px;
      min-width: 26px;
      border-width: 1.5px;
    }
    .tool-btn {
      padding: 4px 7px;
      font-size: 14px;
    }
    #sizeSlider {
      width: 50px;
    }
    .separator {
      height: 20px;
    }
    .size-control {
      padding: 2px 6px;
    }
  }

  @media (max-width: 480px) {
    .toolbar {
      top: 3px;
      padding: 4px 6px;
      gap: 3px;
      flex-wrap: wrap;
      max-width: 98vw;
      border-radius: 15px;
    }
    .color-btn {
      width: 24px;
      height: 24px;
      min-width: 24px;
      border-width: 1.5px;
    }
    .tool-btn {
      padding: 3px 6px;
      font-size: 13px;
    }
    #sizeSlider {
      width: 45px;
    }
    .separator {
      display: none;
    }
    .size-control {
      padding: 2px 5px;
    }
  }
</style>

<div class="toolbar">
  <div class="color-btn active" data-color="#FF6B6B" style="background-color: #FF6B6B;" title="Red"></div>
  <div class="color-btn" data-color="#FFA07A" style="background-color: #FFA07A;" title="Orange"></div>
  <div class="color-btn" data-color="#F7DC6F" style="background-color: #F7DC6F;" title="Yellow"></div>
  <div class="color-btn" data-color="#52BE80" style="background-color: #52BE80;" title="Green"></div>
  <div class="color-btn" data-color="#45B7D1" style="background-color: #45B7D1;" title="Blue"></div>
  <div class="color-btn" data-color="#BB8FCE" style="background-color: #BB8FCE;" title="Purple"></div>

  <div class="separator"></div>

  <div class="size-control">
    <span style="font-size: 11px;">üñåÔ∏è</span>
    <input type="range" id="sizeSlider" min="5" max="80" value="25">
    <div class="brush-preview" id="brushPreview"></div>
  </div>

  <div class="separator"></div>

  <button class="tool-btn active" id="brushBtn" title="Round Brush">‚ö´</button>
  <button class="tool-btn" id="starBtn" title="Star Stamp">‚≠ê</button>
  <button class="tool-btn" id="heartBtn" title="Heart Stamp">‚ù§Ô∏è</button>

  <div class="separator"></div>

  <button class="tool-btn" id="clearBtn" title="Clear Canvas">üóëÔ∏è</button>
</div>

<svg id="svgbox" xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
  <rect id="background" width="100%" height="100%" fill="#FFFFFF"/>
  <g id="elGroup"></g>
</svg>

<script type="text/javascript" defer>
  document.addEventListener("DOMContentLoaded", function(){
    var mouseDown = 0;
    var color = '#FF6B6B';
    var size = 25;
    var tool = 'brush'; // 'brush', 'star', 'heart'
    var lastX = null;
    var lastY = null;

    var svgEl = document.getElementById('svgbox');
    var brushPreview = document.getElementById('brushPreview');

    // Set SVG size
    function resizeSVG() {
      svgEl.setAttribute('width', window.innerWidth);
      svgEl.setAttribute('height', window.innerHeight);
    }
    resizeSVG();

    // Update brush preview
    function updateBrushPreview() {
      brushPreview.style.width = Math.max(10, Math.min(40, size)) + 'px';
      brushPreview.style.height = Math.max(10, Math.min(40, size)) + 'px';
      brushPreview.style.backgroundColor = color;
    }
    updateBrushPreview();

    // Mouse state tracking
    document.body.onmousedown = function() { mouseDown = 1; }
    document.body.onmouseup = function() { mouseDown = 0; lastX = null; lastY = null; }

    // Paint functions
    function paintCircle(x, y) {
      var box = document.getElementById('elGroup');
      var circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
      circle.setAttribute('cx', x);
      circle.setAttribute('cy', y);
      circle.setAttribute('r', size / 2);
      circle.setAttribute('fill', color);
      circle.setAttribute('opacity', '0.9');
      box.appendChild(circle);
    }

    function paintStar(x, y) {
      var box = document.getElementById('elGroup');
      var star = document.createElementNS("http://www.w3.org/2000/svg", "path");
      var points = 5;
      var outerRadius = size;
      var innerRadius = size / 2.5;
      var angle = Math.PI / points;
      var path = '';

      for (var i = 0; i < 2 * points; i++) {
        var radius = i % 2 === 0 ? outerRadius : innerRadius;
        var currAngle = i * angle - Math.PI / 2;
        var px = x + radius * Math.cos(currAngle);
        var py = y + radius * Math.sin(currAngle);
        path += (i === 0 ? 'M' : 'L') + px + ',' + py;
      }
      path += 'Z';

      star.setAttribute('d', path);
      star.setAttribute('fill', color);
      star.setAttribute('opacity', '0.9');
      box.appendChild(star);
    }

    function paintHeart(x, y) {
      var box = document.getElementById('elGroup');
      var heart = document.createElementNS("http://www.w3.org/2000/svg", "path");
      var s = size / 20; // scale factor

      // Heart shape path (centered at 0,0, then translated)
      var path = `M ${x} ${y + 5*s}
                  C ${x} ${y + 2*s}, ${x - 5*s} ${y - 3*s}, ${x - 10*s} ${y - 3*s}
                  C ${x - 15*s} ${y - 3*s}, ${x - 20*s} ${y + 2*s}, ${x - 20*s} ${y + 7*s}
                  C ${x - 20*s} ${y + 12*s}, ${x - 15*s} ${y + 17*s}, ${x} ${y + 25*s}
                  C ${x + 15*s} ${y + 17*s}, ${x + 20*s} ${y + 12*s}, ${x + 20*s} ${y + 7*s}
                  C ${x + 20*s} ${y + 2*s}, ${x + 15*s} ${y - 3*s}, ${x + 10*s} ${y - 3*s}
                  C ${x + 5*s} ${y - 3*s}, ${x} ${y + 2*s}, ${x} ${y + 5*s} Z`;

      heart.setAttribute('d', path);
      heart.setAttribute('fill', color);
      heart.setAttribute('opacity', '0.9');
      box.appendChild(heart);
    }

    function paint(x, y) {
      // Smooth drawing - interpolate between points
      if (lastX !== null && lastY !== null) {
        var dist = Math.hypot(x - lastX, y - lastY);
        var steps = Math.max(1, Math.floor(dist / (size / 3)));

        for (var i = 0; i <= steps; i++) {
          var interpX = lastX + (x - lastX) * (i / steps);
          var interpY = lastY + (y - lastY) * (i / steps);

          if (tool === 'brush') {
            paintCircle(interpX, interpY);
          } else if (tool === 'star') {
            if (i === steps) paintStar(interpX, interpY); // Only end point for stamps
          } else if (tool === 'heart') {
            if (i === steps) paintHeart(interpX, interpY);
          }
        }
      } else {
        if (tool === 'brush') {
          paintCircle(x, y);
        } else if (tool === 'star') {
          paintStar(x, y);
        } else if (tool === 'heart') {
          paintHeart(x, y);
        }
      }

      lastX = x;
      lastY = y;
    }

    // Color selection
    document.querySelectorAll('.color-btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        color = this.dataset.color;
        updateBrushPreview();
      });
    });

    // Size slider
    document.getElementById('sizeSlider').addEventListener('input', function() {
      size = parseInt(this.value);
      updateBrushPreview();
    });

    // Tool selection
    document.getElementById('brushBtn').addEventListener('click', function(e) {
      e.stopPropagation();
      document.querySelectorAll('.tool-btn').forEach(b => {
        if (b.id.endsWith('Btn') && b.id !== 'clearBtn') b.classList.remove('active');
      });
      this.classList.add('active');
      tool = 'brush';
    });

    document.getElementById('starBtn').addEventListener('click', function(e) {
      e.stopPropagation();
      document.querySelectorAll('.tool-btn').forEach(b => {
        if (b.id.endsWith('Btn') && b.id !== 'clearBtn') b.classList.remove('active');
      });
      this.classList.add('active');
      tool = 'star';
    });

    document.getElementById('heartBtn').addEventListener('click', function(e) {
      e.stopPropagation();
      document.querySelectorAll('.tool-btn').forEach(b => {
        if (b.id.endsWith('Btn') && b.id !== 'clearBtn') b.classList.remove('active');
      });
      this.classList.add('active');
      tool = 'heart';
    });

    // Clear button
    document.getElementById('clearBtn').addEventListener('click', function(e) {
      e.stopPropagation();
      if (confirm('Clear the canvas? üé®')) {
        document.getElementById('elGroup').innerHTML = '';
      }
    });

    // Prevent toolbar clicks from painting
    document.querySelector('.toolbar').addEventListener('click', function(e) {
      e.stopPropagation();
    });
    document.querySelector('.toolbar').addEventListener('touchstart', function(e) {
      e.stopPropagation();
    });
    document.querySelector('.toolbar').addEventListener('touchmove', function(e) {
      e.stopPropagation();
    });

    // Mouse events
    window.addEventListener("mousedown", function(e) {
      if (!e.target.closest('.toolbar')) {
        paint(e.clientX, e.clientY);
      }
    });

    window.addEventListener("mousemove", function(e) {
      if (mouseDown && !e.target.closest('.toolbar')) {
        paint(e.clientX, e.clientY);
      }
    });

    window.addEventListener("mouseup", function() {
      lastX = null;
      lastY = null;
    });

    // Touch events
    window.addEventListener("touchstart", function(e) {
      if (!e.target.closest('.toolbar')) {
        e.preventDefault();
        var touch = e.touches[0];
        mouseDown = 1;
        paint(touch.clientX, touch.clientY);
      }
    }, { passive: false });

    window.addEventListener("touchmove", function(e) {
      if (!e.target.closest('.toolbar')) {
        e.preventDefault();
        var touch = e.touches[0];
        paint(touch.clientX, touch.clientY);
      }
    }, { passive: false });

    window.addEventListener("touchend", function(e) {
      if (!e.target.closest('.toolbar')) {
        e.preventDefault();
        mouseDown = 0;
        lastX = null;
        lastY = null;
      }
    }, { passive: false });

    // Resize handling
    window.addEventListener('resize', resizeSVG);
  });
</script>
<script>
  navigator.serviceWorker.register('/sw.js')
    .then(reg => console.log('SW registered!', reg))
    .catch(err => console.log('Boo!', err));
</script>
